package xcorexview.metrics.classes;
import java.io.LineNumberReader;
import java.io.StringReader;
import java.util.Scanner;

import org.eclipse.jdt.core.IType;
import org.eclipse.jdt.core.JavaModelException;

import xmetamodel.XClass;

import com.salexandru.xcorex.interfaces.IPropertyComputer;
import com.salexandru.xcorex.metaAnnotation.PropertyComputer;

@PropertyComputer
public class NumberOfLines implements IPropertyComputer<Integer, XClass> {
	@Override
	public Integer compute(XClass entity) {
		final IType unit = entity.getUnderlyingObject();
		
		try {
			final String commentsRegex = "(?://.*)|(/\\*(?:.|[\\n\\r])*?\\*/)";
			System.out.println(unit.getSource());
			final String sourceCode = unit.getSource().replaceAll(commentsRegex, "");
			System.out.println(unit.getSource());
			
			int count = 0;
			for (final Scanner scanner = new Scanner(sourceCode); scanner.hasNext(); scanner.next())
				++count;
			
			return count;
			
		} catch (JavaModelException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		
		return 0;
	}
}
